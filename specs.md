# specs.md

## Цель проекта

Создать инструмент для автоматизации end-to-end тестирования веб-интерфейсов, который:
- Позволяет описывать сценарии тестов только в терминах "что сделать" (например, "залогинься", "прочитай статью", "оформи заказ"), без явного указания локаторов и структуры DOM.
- Автоматически находит нужные элементы на странице и выполняет действия, даже если верстка или структура страницы меняется.
- Использует Playwright для взаимодействия с браузером.
- Использует LLM (OpenAI GPT-4/4o) как помощника для поиска элементов, но не полагается на него полностью.

---

## Основные требования

1. **Гибкость сценариев**
   - Тест-кейсы описываются только действиями пользователя (что сделать), без указания как именно найти элементы.
   - Пример:  
     - "Залогинься с логином X и паролем Y"
     - "Найди и прочитай статью 'BioWorld Today'"
     - "Добавь товар в корзину"

2. **Автоматический поиск элементов**
   - Система должна уметь находить нужные поля, кнопки, ссылки и т.д. по смыслу, а не по жёстко заданным локаторам.
   - Для этого используется:
     - Парсинг DOM через Playwright (поиск по тексту, атрибутам, структуре)
     - LLM для генерации подсказок или fallback-локаторов

3. **Устойчивость к изменению верстки**
   - Если структура страницы изменилась (например, поменялись классы, порядок блоков), тесты должны продолжать работать, если смысловые элементы остались.

4. **Валидация и безопасность**
   - Все локаторы, сгенерированные LLM, проходят фильтрацию и валидацию на стороне кода.
   - Если не найден уникальный элемент — тест должен завершиться с ошибкой и логом.

5. **Расширяемость**
   - Возможность добавлять новые сценарии без изменения кода поиска элементов.

---

## Архитектура

- **Playwright** — основной инструмент для управления браузером и парсинга DOM.
- **OpenAI GPT-4/4o** — помощник для генерации локаторов/подсказок по HTML/JSON страницы.
- **JS-логика** — основной способ поиска элементов (поиск по тексту, структуре, атрибутам).
- **Фильтрация** — все локаторы, сгенерированные LLM, проходят строгую фильтрацию и валидацию.

---

## Пример сценария

1. Открыть страницу логина.
2. Найти поля для логина и пароля (по placeholder, label, aria-label, тексту рядом).
3. Ввести логин и пароль.
4. Найти и нажать кнопку "Войти" (по тексту, типу, роли).
5. Проверить успешный вход (например, по наличию элемента профиля).

---

## Ограничения

- LLM не гарантирует 100% валидные локаторы — всегда нужна фильтрация и fallback на JS-поиск.
- Для сложных случаев (уникальный элемент по смыслу) предпочтителен программный анализ DOM.

---

## TODO

- [ ] Реализовать универсальный парсер элементов страницы в JSON (заголовки, кнопки, поля, ссылки).
- [ ] Реализовать функцию поиска элемента по смыслу (заголовок + кнопка и т.д.).
- [ ] Интегрировать LLM для генерации подсказок и fallback-локаторов.
- [ ] Реализовать фильтрацию и валидацию локаторов.
- [ ] Описать примеры сценариев на естественном языке.

---

**Этот файл — основа для обсуждения и развития проекта.**